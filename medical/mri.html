<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script>
        window.MathJax = { tex: { inlineMath: [['$', '$']], displayMath: [['\\[', '\\]']] } };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title>ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ø±Ù†ÙŠÙ† Ø§Ù„Ù…ØºÙ†Ø§Ø·ÙŠØ³ÙŠ - ÙƒØ§Ù…ÙŠØ±Ø§ Ø·Ø¨ÙŠØ©</title>
    <style>
        .mri-tool { background: linear-gradient(45deg, #001f3f, #002b55); border: 2px solid var(--yellow); }
        .math-box { font-size: 1.5rem; color: var(--yellow); text-align: center; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 12px; margin: 15px 0; }
        .lessons-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 30px; }
        .modal { display: none; position: fixed; z-index: 2000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); overflow-y: auto; }
        .modal-content { background: var(--bg-color); margin: 5% auto; padding: 30px; width: 90%; max-width: 850px; border-radius: 20px; border: 2px solid var(--yellow); }
    </style>
</head>
<body>
    <nav>
        <a href="index.html" class="logo">ÙƒØ§Ù…ÙŠØ±Ø§ Ø·Ø¨ÙŠØ© ğŸ“·</a>
        <div class="dropdown">
            <button onclick="toggleMenu()" class="dropbtn">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© â˜°</button>
            <div id="myDropdown" class="dropdown-content">
                 <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a href="physics_calc.html">Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ© ğŸ§®</a>
                <a href="contrast_guide.html">Ø¯Ù„ÙŠÙ„ Ø§Ù„ØµØ¨ØºØ§Øª ğŸ§ª</a>
                <a href="exam.html">Ù…Ø±ÙƒØ² Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</a>
                <a href="anatomy.html">ØªØ­Ø¯ÙŠ Ø§Ù„ØªØ´Ø±ÙŠØ­</a>
                <a href="atlas.html">Ø£Ø·Ù„Ø³ Ø§Ù„ÙˆØ¶Ø¹ÙŠØ§Øª</a>
                <a href="artifacts.html">Ù…Ø®ØªØ¨Ø± Ø§Ù„ØµÙˆØ±</a>
                <a href="safety.html">ØªØ­Ø¯ÙŠ Ø§Ù„Ø³Ù„Ø§Ù…Ø©</a>
                <a href="ct.html">CT Scan</a>
                <a href="xray.html">X-ray</a>
                <a href="mri.html">MRI</a>
                <a href="ultrasound.html">ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ø³ÙˆÙ†Ø§Ø± ğŸ”Š</a>
                <a href="qc_lab.html">Ù…Ø®ØªØ¨Ø± Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ù†ÙˆØ¹ÙŠØ© ğŸ› ï¸</a>
                <a href="protection.html">Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹ÙŠØ© ğŸ›¡ï¸</a>
                <a href="physics_sim.html">Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ âš›ï¸</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="card mri-tool">
            <h2 style="color:var(--yellow); text-align:center;">ğŸ“¡ Ø­Ø§Ø³Ø¨Ø© ØªØ±Ø¯Ø¯ Ù„Ø§Ø±Ù…ÙˆØ± (Larmor Frequency)</h2>
            <div class="math-box">
                \[ f = \gamma \times B_0 \]
            </div>
            <p style="text-align:center; color: #ccc;">ØªØ±Ø¯Ø¯ Ø§Ù„Ø±Ù†ÙŠÙ† Ù„Ù„Ù‡ÙŠØ¯Ø±ÙˆØ¬ÙŠÙ† Ø­ÙŠØ« $\gamma \approx 42.58 \text{ MHz/T}$</p>
            
            <div style="max-width:300px; margin: 0 auto;">
                <label>Ù‚ÙˆØ© Ø§Ù„Ù…ØºÙ†Ø§Ø·ÙŠØ³ (Tesla):</label>
                <input type="number" id="tesla-input" value="1.5" step="0.1" style="width:100%; padding:12px; border-radius:8px; border:1px solid var(--yellow); background:rgba(255,255,255,0.05); color:white;">
                <button class="btn-primary" style="margin-top:15px;" onclick="calculateLarmor()">Ø§Ø­Ø³Ø¨ Ø§Ù„ØªØ±Ø¯Ø¯</button>
            </div>
            
            <div id="larmor-result" style="margin-top:20px; text-align:center;"></div>
        </div>

        <h2 style="margin-top:50px; border-bottom: 2px solid var(--yellow); padding-bottom:10px;">ğŸ“š Ù…ÙˆØ³ÙˆØ¹Ø© ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ø±Ù†ÙŠÙ† Ø§Ù„Ù…ØºÙ†Ø§Ø·ÙŠØ³ÙŠ</h2>
        <div id="mri-lessons-container" class="lessons-grid"></div>
    </div>

    <div id="lessonModal" class="modal">
        <div class="modal-content">
            <span onclick="closeModal()" style="float:left; font-size:35px; cursor:pointer; color:var(--orange);">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        function calculateLarmor() {
            const b0 = parseFloat(document.getElementById('tesla-input').value);
            const freq = (b0 * 42.58).toFixed(2);
            document.getElementById('larmor-result').innerHTML = `
                <span style="color:white;">ØªØ±Ø¯Ø¯ Ø§Ù„Ø±Ù†ÙŠÙ†:</span><br>
                <span style="color:var(--yellow); font-size:2rem; font-weight:bold;">${freq}</span>
                <span style="color:white; font-size:1.3rem; margin-right:5px; font-weight:bold;">MHz</span>
            `;
        }

        window.onload = function() {
            const lessons = JSON.parse(localStorage.getItem('mri_lessons')) || [];
            const container = document.getElementById('mri-lessons-container');
            if(lessons.length === 0) { container.innerHTML = "<p style='text-align:center; grid-column:1/-1;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø±ÙˆØ³ Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§.</p>"; return; }
            container.innerHTML = lessons.map((l, i) => `
                <div class="card" style="cursor:pointer; text-align:center; border:1px solid rgba(255,215,0,0.2);" onclick="openLesson(${i})">
                    <h3 style="color:var(--yellow)">${l.titleAr}</h3>
                    <p style="color:#aaa;">${l.titleEn}</p>
                    <button class="btn-primary">ÙØªØ­ Ø§Ù„Ø´Ø±Ø­ ğŸ“–</button>
                </div>
            `).join('');
        };

        function openLesson(i) {
            const lesson = JSON.parse(localStorage.getItem('mri_lessons'))[i];
            let html = `<h2 style="color:var(--yellow)">${lesson.titleAr}</h2><h4 style="color:#8892b0">${lesson.titleEn}</h4><hr>`;
            lesson.content.forEach(b => {
                if(b.type === 'text') html += `<div style="line-height:1.8; margin-bottom:20px; white-space: pre-line;">${b.value}</div>`;
                else if(b.type === 'image') html += `<img src="${b.value}" style="width:100%; border-radius:12px; border:2px solid var(--yellow); margin-bottom:20px;">`;
            });
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('lessonModal').style.display = "block";
            if(window.MathJax) MathJax.typesetPromise();
        }

        function closeModal() { document.getElementById('lessonModal').style.display = "none"; }
        function toggleMenu() { document.getElementById("myDropdown").classList.toggle("show"); }
    </script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="firebase-config.js"></script>
    
    <script>
    window.onload = async function() {
        const COLLECTION = "mri"; // ğŸ’¡ Ù†ÙØ³ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        const snap = await db.collection(COLLECTION).orderBy("createdAt", "desc").get();
        
        document.getElementById('display-grid').innerHTML = snap.docs.map(doc => `
            <div class="card">
                <h3>${doc.data().title}</h3>
                <p>${doc.data().desc}</p>
            </div>
        `).join('');
    };
</script>
</body>
</html>