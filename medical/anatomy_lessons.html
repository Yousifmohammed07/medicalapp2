<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Ø¯Ø±ÙˆØ³ Ø§Ù„ØªØ´Ø±ÙŠØ­ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹ÙŠ - ÙƒØ§Ù…ÙŠØ±Ø§ Ø·Ø¨ÙŠØ©</title>
    <style>
        .lessons-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; padding: 20px 0; }
        .lesson-card { 
            background: var(--card-bg); border-radius: 20px; padding: 25px; text-align: center; 
            border-bottom: 4px solid var(--orange); cursor: pointer; transition: 0.3s;
        }
        .lesson-card:hover { transform: translateY(-5px); border-color: var(--yellow); }
        
        .modal { display: none; position: fixed; z-index: 2000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); padding: 20px; overflow-y: auto; }
        .modal-content { background: var(--bg-color); margin: 2% auto; padding: 30px; border-radius: 25px; border: 1px solid var(--orange); max-width: 800px; position: relative; }
    </style>
</head>
<body>
    <nav>
        <a href="index.html" class="logo">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„ØªØ´Ø±ÙŠØ­ ğŸ“–</a>
        <button class="btn-primary" onclick="location.href='index.html'" style="width:auto; padding: 5px 15px;">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </nav>

    <div class="container">
        <header style="text-align:center; padding: 30px 0;">
            <h1 style="color:var(--yellow)">Ø¯Ø±ÙˆØ³ Ø§Ù„ØªØ´Ø±ÙŠØ­ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹ÙŠ</h1>
            <p>ØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¹Ø¸Ø§Ù… ÙˆØ§Ù„Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ Ù…Ø®ØªÙ„Ù Ø§Ù„ØµÙˆØ± Ø§Ù„Ø·Ø¨ÙŠØ©.</p>
        </header>

        <div id="lessons-display-grid" class="lessons-grid">
            <p style="text-align:center; grid-column:1/-1;">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨...</p>
        </div>
    </div>

    <div id="lessonModal" class="modal">
        <div class="modal-content">
            <span onclick="closeModal()" style="position:absolute; left:20px; top:20px; font-size:35px; cursor:pointer; color:var(--orange);">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-config.js"></script>

    <script>
        async function loadLessons() {
            const grid = document.getElementById('lessons-display-grid');
            const snap = await db.collection("anatomy_lessons").orderBy("createdAt", "desc").get();
            
            if(snap.empty) {
                grid.innerHTML = "<p style='grid-column:1/-1; text-align:center;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø±ÙˆØ³ Ø­Ø§Ù„ÙŠØ§Ù‹.</p>";
                return;
            }

            grid.innerHTML = snap.docs.map(doc => {
                const d = doc.data();
                return `
                <div class="lesson-card" onclick='openLesson(${JSON.stringify(d).replace(/'/g, "&apos;")})'>
                    <div style="font-size:3.5rem; margin-bottom:15px;">${d.icon}</div>
                    <h3 style="color:var(--yellow)">${d.title}</h3>
                    <p style="font-size:0.9rem; color:#aaa; margin-top:10px;">Ø§Ù†Ù‚Ø± Ù„ÙØªØ­ Ù…Ù„Ù Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„Ø´Ø§Ù…Ù„</p>
                </div>`;
            }).join('');
        }

        function openLesson(lesson) {
            const body = document.getElementById('modal-body');
            body.innerHTML = `
                <h2 style="color:var(--yellow);">${lesson.icon} ${lesson.title}</h2>
                <hr style="border:0.1px solid #333; margin:20px 0;">
                
                ${lesson.img ? `<div style="text-align:center; margin-bottom:25px;">
                    <img src="${lesson.img}" style="max-width:100%; border-radius:15px; border:2px solid #222;">
                </div>` : ''}

                <div style="white-space:pre-line; line-height:1.8; color:#eee; font-size:1.1rem;">
                    ${lesson.content}
                </div>
            `;
            document.getElementById('lessonModal').style.display = "block";
        }

        function closeModal() { document.getElementById('lessonModal').style.display = "none"; }
        window.onclick = e => { if(e.target.className === 'modal') closeModal(); };
        window.onload = loadLessons;
    </script>
</body>
</html>