<!DOCTYPE html>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="firebase-config.js"></script>

<script>
    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    firebase.auth().onAuthStateChanged((user) => {
        if (!user) {
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø³Ø¬Ù„Ø§Ù‹ØŒ Ø§Ø·Ø±Ø¯Ù‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            window.location.href = "login.html";
        }
    });

    function logout() {
        firebase.auth().signOut().then(() => {
            window.location.href = "login.html";
        });
    }
</script>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ù…ÙˆØ³ - ÙƒØ§Ù…ÙŠØ±Ø§ Ø·Ø¨ÙŠØ©</title>
    <style>
        .input-group { margin-bottom: 15px; }
        input, textarea { 
            width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--orange); 
            background: rgba(255,255,255,0.05); color: white; box-sizing: border-box; 
        }
        label { display: block; margin-bottom: 5px; color: var(--yellow); }
    </style>
</head>
<body>
    <nav>
        <a href="admin_hub.html" class="logo">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ù…ÙˆØ³ ğŸ“–</a>
        <button class="btn-primary" onclick="location.href='admin_hub.html'" style="width:auto; padding: 5px 15px;">â¬…ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø±ÙƒØ²</button>
    </nav>

    <div class="container">
        <div class="card">
            <h2 style="color:var(--orange); text-align:center;">â• Ø¥Ø¶Ø§ÙØ© Ù…ØµØ·Ù„Ø­ Ø¬Ø¯ÙŠØ¯</h2>
            
            <div class="input-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div class="input-group">
                    <label>Ø§Ù„Ù…ØµØ·Ù„Ø­ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ:</label>
                    <input type="text" id="term-ar" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„ÙˆÙ‡Ù†">
                </div>
                <div class="input-group">
                    <label>Ø§Ù„Ù…ØµØ·Ù„Ø­ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ:</label>
                    <input type="text" id="term-en" placeholder="e.g., Attenuation" dir="ltr">
                </div>
            </div>

            <div class="input-group">
                <label>Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠ Ø§Ù„Ù…Ø¨Ø³Ø·:</label>
                <textarea id="term-def" rows="4" placeholder="Ø§Ø´Ø±Ø­ Ù…Ø¹Ù†Ù‰ Ø§Ù„Ù…ØµØ·Ù„Ø­ Ø¨Ø§Ø®ØªØµØ§Ø±..."></textarea>
            </div>

            <div class="input-group">
                <label>ØµÙˆØ±Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
                <input type="file" id="term-img" accept="image/*">
            </div>
            
            <button class="btn-primary" onclick="saveTerm()">ğŸš€ Ø­ÙØ¸ Ø§Ù„Ù…ØµØ·Ù„Ø­</button>
        </div>

        <div class="card">
            <h3 style="color:var(--yellow);">ğŸ“‚ Ø§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø©:</h3>
            <div id="dict-list"></div>
        </div>
    </div>

    <script>
        async function saveTerm() {
            const ar = document.getElementById('term-ar').value;
            const en = document.getElementById('term-en').value;
            const def = document.getElementById('term-def').value;
            const imgFile = document.getElementById('term-img').files[0];

            if(!ar || !en || !def) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒØ§ÙØ© Ø§Ù„Ø­Ù‚ÙˆÙ„!");

            let imageData = "";
            if (imgFile) {
                imageData = await new Promise(resolve => {
                    const reader = new FileReader();
                    reader.onload = e => resolve(e.target.result);
                    reader.readAsDataURL(imgFile);
                });
            }

            const newTerm = { id: Date.now(), ar, en, def, img: imageData };
            let dictionary = JSON.parse(localStorage.getItem('radiology_dict')) || [];
            dictionary.push(newTerm);
            localStorage.setItem('radiology_dict', JSON.stringify(dictionary));
            
            alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ØµØ·Ù„Ø­!");
            location.reload();
        }

        window.onload = function() {
            const list = document.getElementById('dict-list');
            const dict = JSON.parse(localStorage.getItem('radiology_dict')) || [];
            list.innerHTML = dict.map((item, i) => `
                <div style="display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #333;">
                    <span><b>${item.ar}</b> - ${item.en}</span>
                    <button onclick="deleteTerm(${i})" style="color:red; background:none; border:none; cursor:pointer;">Ø­Ø°Ù ğŸ—‘ï¸</button>
                </div>
            `).join('');
        };

        function deleteTerm(i) {
            let dict = JSON.parse(localStorage.getItem('radiology_dict'));
            dict.splice(i, 1);
            localStorage.setItem('radiology_dict', JSON.stringify(dict));
            location.reload();
        }
    </script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="firebase-config.js"></script>
    
    
    <script>
    const COLLECTION = "dictionary"; // ğŸ’¡ ØºÙŠØ±Ù‡Ø§ Ø¥Ù„Ù‰ us_lessons Ø£Ùˆ rad_protection Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø©

    async function saveData() {
        const title = document.querySelector('input').value;
        const desc = document.querySelector('textarea').value;
        
        await db.collection(COLLECTION).add({
            title, desc, createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        location.reload();
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø­Ø°Ù
    window.onload = async function() {
        const snap = await db.collection(COLLECTION).orderBy("createdAt", "desc").get();
        document.getElementById('data-list').innerHTML = snap.docs.map(doc => `
            <div style="display:flex; justify-content:space-between; padding:10px;">
                <span>${doc.data().title}</span>
                <button onclick="db.collection('${COLLECTION}').doc('${doc.id}').delete().then(()=>location.reload())">Ø­Ø°Ù ğŸ—‘ï¸</button>
            </div>
        `).join('');
    };
</script>
</body>
</html>