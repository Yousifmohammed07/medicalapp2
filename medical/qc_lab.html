<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Ù…Ø®ØªØ¨Ø± Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ù†ÙˆØ¹ÙŠØ© - ÙƒØ§Ù…ÙŠØ±Ø§ Ø·Ø¨ÙŠØ©</title>
    <style>
        .qc-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        .qc-card { background: var(--card-bg); border-radius: 20px; padding: 25px; border-left: 5px solid var(--orange); cursor: pointer; transition: 0.3s; }
        .qc-card:hover { transform: translateY(-5px); border-color: var(--yellow); }
        .device-badge { background: var(--orange); color: var(--navy); padding: 3px 12px; border-radius: 6px; font-size: 0.8rem; font-weight: bold; }
        
        .modal { display: none; position: fixed; z-index: 3000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); overflow-y: auto; padding: 20px; }
        .modal-content { background: var(--bg-color); margin: 2% auto; padding: 30px; width: 95%; max-width: 850px; border-radius: 25px; border: 1px solid var(--yellow); position: relative; }
    </style>
</head>
<body>
    <nav>
        <a href="index.html" class="logo">ÙƒØ§Ù…ÙŠØ±Ø§ Ø·Ø¨ÙŠØ© ğŸ“·</a>
        <button class="btn-primary" onclick="location.href='index.html'" style="width:auto; padding: 5px 15px;">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </nav>

    <div class="container">
        <h1 style="text-align:center; color:var(--yellow); margin-top:20px;">ğŸ› ï¸ Ù…Ø®ØªØ¨Ø± Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ù†ÙˆØ¹ÙŠØ© Ù„Ù„Ø£Ø¬Ù‡Ø²Ø©</h1>
        <div id="qc-display-grid" class="qc-grid">
            <p style="text-align:center; grid-column:1/-1;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª...</p>
        </div>
    </div>

    <div id="qcModal" class="modal">
        <div class="modal-content">
            <span onclick="closeModal()" style="position:absolute; left:20px; top:20px; font-size:35px; cursor:pointer; color:var(--orange);">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-config.js"></script>

    <script>
        const COLLECTION = "qc_tests";

        async function loadQCDisplay() {
            const grid = document.getElementById('qc-display-grid');
            try {
                const snap = await db.collection(COLLECTION).orderBy("createdAt", "desc").get();
                if(snap.empty) {
                    grid.innerHTML = "<p style='grid-column:1/-1; text-align:center;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.</p>";
                    return;
                }
                grid.innerHTML = snap.docs.map(doc => {
                    const item = doc.data();
                    return `
                    <div class="qc-card" onclick='openQC(${JSON.stringify(item).replace(/'/g, "&apos;")})'>
                        <span class="device-badge">${item.device}</span>
                        <h3 style="margin-top:15px; color:var(--yellow);">${item.name}</h3>
                        <p style="font-size:0.85rem; color:#aaa; margin-top:10px;">Ø§Ù†Ù‚Ø± Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©.</p>
                    </div>`;
                }).join('');
            } catch (e) { grid.innerHTML = "Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª."; }
        }

        function openQC(test) {
            const body = document.getElementById('modal-body');
            body.innerHTML = `
                <h2 style="color:var(--yellow);">${test.name}</h2>
                <span class="device-badge">${test.device}</span>
                <hr style="border:0.1px solid #333; margin:20px 0;">
                
                <h4 style="color:var(--orange)">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ù…Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h4>
                <p style="color:#eee; margin-bottom:20px;">${test.goal || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>

                <h4 style="color:var(--orange)">ğŸ› ï¸ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</h4>
                <p style="color:#eee; margin-bottom:20px;">${test.tools || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                
                <h4 style="color:var(--orange)">ğŸ“ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡:</h4>
                <p style="white-space:pre-line; line-height:1.8; color:#eee;">${test.proc}</p>
                
                <h4 style="color:var(--orange); margin-top:25px;">âš–ï¸ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‚Ø¨ÙˆÙ„ ÙˆØ§Ù„Ø±ÙØ¶:</h4>
                <div style="background:rgba(255,215,0,0.05); padding:15px; border-radius:12px; border-right:5px solid var(--yellow);">
                    ${test.limit}
                </div>
                
                ${test.img ? `<div style="margin-top:25px; text-align:center;">
                    <img src="${test.img}" style="max-width:100%; border-radius:15px; border:1px solid #444;">
                </div>` : ''}
            `;
            document.getElementById('qcModal').style.display = "block";
        }

        function closeModal() { document.getElementById('qcModal').style.display = "none"; }
        window.onload = loadQCDisplay;
    </script>
</body>
</html>